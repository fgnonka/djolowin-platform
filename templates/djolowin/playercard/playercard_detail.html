{% extends "djolowin/main.html" %} {% block content %} {% load static %} {% load humanize %}

<div class="container">
	<div class="card-title">
		<h1 class="text-white">{{playercard.player.name}}</h1>
		<h5 class="text-white">{{playercard.rarity.name}} {{ playercard.index }}/{{ playercard.get_total_card_index }}</h5>
	</div>
	<div class="flex-container" style="border-radius: 20px">
		<div class="flex-child" style="display: flex; justify-content: center; align-items: center">
			<div class="d-flex">
				<div class="p-2">{% include "djolowin/playercard/model/playercard.html" %}</div>
			</div>
		</div>
		<div class="flex-child">
			<div class="d-flex">
				<div class="p-2 flex-grow-1">
					<div class="flex-child">
						<h3 class="text-white">Card Details</h3>
					</div>
					<div class="detail-group">
						{% if playercard.owner %}
						<div class="flex-child">
							<div class="d-flex">
								<div class="p-2 flex-grow-1">
									<h1 style="color: white; font-size: 15px">Owner</h1>
								</div>
								<div class="p-2">
									<h1 style="color: white; font-size: 15px">
										<a>{{ playercard.owner.username}}</a>
									</h1>
								</div>
							</div>
						</div>
						{% endif %}
						<div class="flex-child">
							<div class="d-flex">
								<div class="p-2 flex-grow-1">
									<h1 style="color: white; font-size: 15px">Team</h1>
								</div>
								<div class="p-2">
									<h1 style="color: white; font-size: 15px">
										<a> {{ playercard.player.team.name }} {{ playercard.player.team.year }} </a>
									</h1>
								</div>
							</div>
						</div>
						<div class="flex-child">
							<div class="d-flex">
								<div class="p-2 flex-grow-1">
									<h1 style="color: white; font-size: 15px">Country</h1>
								</div>
								<div class="p-2">
									<h1 style="color: white; font-size: 15px">
										<a> {{ playercard.player.country.country.name }} </a>
									</h1>
								</div>
							</div>
						</div>
						<div class="flex-child">
							<div class="d-flex">
								<div class="p-2 flex-grow-1">
									<h1 style="color: white; font-size: 15px">Rarity</h1>
								</div>
								<div class="p-2">
									<h1 style="color: white; font-size: 15px">
										<a> {{ playercard.rarity.name }}</a>
									</h1>
								</div>
							</div>
						</div>
						<div class="flex-child">
							<div class="d-flex">
								<div class="p-2 flex-grow-1">
									<h1 style="color: white; font-size: 15px">Index</h1>
								</div>
								<div class="p-2">
									<h1 style="color: white; font-size: 15px">
										<a> {{ playercard.index }} </a>
									</h1>
								</div>
							</div>
						</div>
						<div class="flex-child">
							<div class="d-flex">
								<div class="p-2 flex-grow-1">
									<h1 style="color: white; font-size: 15px">Price</h1>
								</div>
								<div class="p-2">
									<h1 style="color: white; font-size: 15px">
										<a> {{ playercard.price }} DJOBA </a>
									</h1>
								</div>
							</div>
						</div>
					</div>
					<div class="d-flex">
						<div class="p-2 flex-grow-1">
							{% comment %} change the is_public to "Hide my card" {% endcomment %}
							{% if request.user == playercard.owner %} {% if not playercard.is_locked %}
							<button id="modify-price-btn" class="btn search-btn">Modify Card</button>
						</div>
						<div class="p-2">
							{% if not active_auctions %}
							
							<a class="text-decoration-none lightext" href="{% url 'auction:create_auction' card_pk=playercard.pk %}">
								<button  class="btn secondary-search-btn">Create an Auction for this card</button>
							</a>
							{% endif %}
							<div id="modify-price-form" style="display: none">
								<form method="post" action="{% url 'playercard:update_price' playercard.id %}">
									{% csrf_token %} {{ form.as_p }}
									<button class="btn" type="submit">
										<span class="badge badge-default rounded-pill text-dark">Update Price</span>
									</button>
								</form>
							</div>
						</div>
						{% endif %}{% endif %}
					</div>
				</div>
			</div>
		</div>
		<div class="group mt-5">
			<h3 class="text-white">Last {{ playercard.rarity.name }} Auctions</h3>
			<div class="flex-child">
				<div class="d-flex">
					{% for auction in past_auctions %}
					<div class="p-2 flex-grow-1">
						<h1 style="color: white; font-size: 15px">{{auction.card.player.name}}</h1>
					</div>
					<div class="p-2">
						<h1 style="color: white; font-size: 15px">
							<a> {{ auction.current_bid }} DJOBA </a>
						</h1>
					</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>
</div>
<script>
	const modifyPriceBtn = document.querySelector("#modify-price-btn");
	const modifyPriceForm = document.querySelector("#modify-price-form");

	modifyPriceBtn.addEventListener("click", () => {
		modifyPriceForm.style.display = "block";
	});
</script>
{% endblock content %}
